{"version":3,"sources":["scripts/contentscript.js"],"names":["xOffset","yOffset","absoluteCursorPos","relativeCursorPos","anchorSelector","ajaxRequest","Mx","My","pictresCache","linkTypes","title","anon","posterSelector","character","name","loadingGif","preloadLoadingGif","Image","src","$","document","width","height","setCoordinates","e","x","pageX","y","pageY","clientX","clientY","createPreview","urlParts","this","attr","split","type","id","$img","appendTo","setPicture","calculatePreviewPosition","fadeIn","removePreview","remove","abort","topValue","leftValue","trc_x","trc_y","Math","min","window","css","fetchPicture","success","html","imageSrc","find","setPictureSRC","complete","xhr","status","ajax","url","dataType","beforeSend","padding","load","body","on"],"mappings":"AAUA,GAAIA,SAAU,EACVC,QAAU,GACVC,qBACAC,qBAEAC,eAAgBC,YAAaC,GAAIC,GACjCC,gBAEAC,WACAC,OACIC,KAAM,yFACNC,eAAgB,eAEpBC,WACIF,KAAM,sGACNC,eAAgB,cAEpBE,MACIH,KAAM,sGACNC,eAAgB,iBAKpBG,WAAa,sGACbC,kBAAoB,GAAIC,MAC5BD,mBAAkBE,IAAMH,WAGxBT,GAAKa,EAAEC,UAAUC,QACjBd,GAAKY,EAAEC,UAAUE,QAIjB,IAAIC,gBAAiB,SAASC,GAC1BtB,mBACIuB,EAAGD,EAAEE,MACLC,EAAGH,EAAEI,OAGTzB,mBACIsB,EAAGD,EAAEK,QACLF,EAAGH,EAAEM,UAITC,cAAgB,SAASP,GACzB,GAAIQ,GAAWb,EAAEc,MAAMC,KAAK,QAAQC,MAAM,KACtCC,EAAOJ,EAAS,GAChBK,EAAKL,EAAS,GACdM,EAAOnB,EAAE,wKAAyKJ,WAAY,QAAQwB,SAAS,OAEnNC,YAAWJ,EAAMC,EAAIC,GAErBG,2BACAH,EAAKI,OAAO,SAGZC,cAAgB,WAChBxB,EAAE,kBAAkByB,SAChBvC,aACAA,YAAYwC,SAIhBJ,yBAA2B,WAE3B,GACIK,GAAUC,EADVT,EAAOnB,EAAE,kBAET6B,EAAQhD,QAAUsC,EAAKjB,QACvB4B,EAAQhD,QAAUqC,EAAKhB,QAE3B0B,GAAQE,KAAKC,IAAIH,EAAQ9C,kBAAkBuB,EAAGnB,IAC9C2C,EAAQC,KAAKC,IAAIF,EAAQ/C,kBAAkByB,EAAGpB,IAE9CuC,EAAWG,EAAQX,EAAKhB,SACxByB,EAAYC,EAAQV,EAAKjB,QAItBiB,EAAKhB,SAAWnB,kBAAkBwB,EAAIR,EAAEiC,QAAQ9B,WAC/CwB,EAAWA,EAAWR,EAAKhB,SAAoB,EAARrB,SAG3CqC,EACKe,IAAI,MAAOP,EAAW,MACtBO,IAAI,OAAQN,EAAY,OAG7BP,WAAa,SAASJ,EAAMC,EAAIC,GAChCgB,aAAalB,EAAMC,GAAIkB,QAAQ,SAASC,GACpC,GAAIC,GAAWtC,EAAEqC,GAAME,KAAKjD,UAAU2B,GAAMxB,gBAAgBsB,KAAK,QAAUzB,UAAU2B,GAAMzB,IAE3FH,cAAa4B,EAAK,IAAIC,GAAMoB,EAC5BE,cAAcrB,EAAMmB,KAErBG,SAAS,SAASC,EAAKC,GACT,YAAVA,GACCH,cAAcrB,EAAM9B,aAAa4B,EAAK,IAAIC,OAKlDiB,aAAe,SAASlB,EAAMC,GAW9B,MAVAhC,aAAcc,EAAE4C,MACZC,IAAK,IAAK5B,EAAM,IAAMC,EACtB4B,SAAU,OACVC,WAAY,SAASL,GACjB,MAAGrD,cAAa4B,EAAK,IAAIC,IACd,EADX,WASRsB,cAAgB,SAASrB,EAAM0B,GAC/B1B,EAAKe,KAAKc,QAAU,MACpB7B,EAAKJ,KAAK,MAAO8B,GAAKI,KAAK,WACvB3B,6BAIR,KAAK,GAAIL,QAAQ3B,WACbL,eAAiB,aAAcgC,KAAM,MACrCjB,EAAEC,SAASiD,MAAMC,GAAG,kBAAmBlE,eAAgBmB,gBAEvDJ,EAAEC,SAASiD,MAAMC,GAAG,aAAclE,eAAgB2B,eAClDZ,EAAEC,SAASiD,MAAMC,GAAG,YAAalE,eAAgBqC,0BACjDtB,EAAEC,SAASiD,MAAMC,GAAG,aAAclE,eAAgBuC","file":"scripts/contentscript.js","sourcesContent":["// ==UserScript==\n// @name\t\t\tIMDB - Big images on hover\n// @author      \tShebo\n// @description\t\tView image while hovering it's thumbnail.\n// @version\t\t\t0.2\n// @include\t\t\thttp://*.imdb.com/*\n// @require\t\t\thttps://code.jquery.com/jquery-2.1.4.min.js\n\n\n/* CONFIG */\nvar xOffset = 5,\n    yOffset = 10,\n    absoluteCursorPos = {},\n    relativeCursorPos = {},\n    // $ = jQuery.noConflict(),\n    anchorSelector, ajaxRequest, Mx, My,\n    pictresCache = {};\n\nvar linkTypes = {\n    title: {\n        anon: \"http://ia.media-imdb.com/images/G/01/imdb/images/poster/movie_large-2652508870._V_.png\",\n        posterSelector: \".poster img\",\n    },\n    character: {\n        anon: \"http://ia.media-imdb.com/images/G/01/imdb/images/nopicture/medium/name-2135195744._CB271220678_.png\",\n        posterSelector: \".photo img\",\n    },\n    name: {\n        anon: \"http://ia.media-imdb.com/images/G/01/imdb/images/nopicture/medium/name-2135195744._CB271220678_.png\",\n        posterSelector: \"#name-poster\",\n    },\n};\n\n// preload loading gif\nvar loadingGif = \"http://ia.media-imdb.com/images/G/01/imdb/images/video/trailers/spinner-featured-3267265562._V_.gif\";\nvar preloadLoadingGif = new Image();\npreloadLoadingGif.src = loadingGif;\n\n\nMx = $(document).width();\nMy = $(document).height();\n\n\n// set coordinates for image\nvar setCoordinates = function(e){\n    absoluteCursorPos = {\n        x: e.pageX,\n        y: e.pageY,\n    };\n\n    relativeCursorPos = {\n        x: e.clientX,\n        y: e.clientY,\n    };\n};\n\nvar createPreview = function(e){\n    var urlParts = $(this).attr('href').split('/'),\n        type = urlParts[1],\n        id = urlParts[2],\n        $img = $('<img id=\"hover-preview\" style=\"position: absolute; border: none; z-index : 1025; display: none; padding: 7px; background: #000 no-repeat scroll center center;\" src=\"'+ loadingGif +'\" />').appendTo(\"body\");\n\n    setPicture(type, id, $img);\n\n    calculatePreviewPosition();\n    $img.fadeIn(\"fast\");\n};\n\nvar removePreview = function(){\n    $(\"#hover-preview\").remove();\n    if (ajaxRequest){\n        ajaxRequest.abort();\n    }\n};\n\nvar calculatePreviewPosition = function(){\n\n    var $img = $(\"#hover-preview\"),\n        topValue, leftValue,\n        trc_x = xOffset + $img.width(),\n        trc_y = yOffset + $img.height();\n\n    trc_x = Math.min(trc_x + absoluteCursorPos.x, Mx);\n    trc_y = Math.min(trc_y + absoluteCursorPos.y, My);\n\n    topValue = trc_y - $img.height();\n    leftValue = trc_x - $img.width();\n\n\n    // if image ends below bottom\n    if($img.height() + relativeCursorPos.y > $(window).height()){\n        topValue = topValue - $img.height() - (yOffset*2);\n    }\n\n    $img\n        .css(\"top\", topValue + \"px\")\n        .css(\"left\", leftValue + \"px\");\n};\n\nvar setPicture = function(type, id, $img){\n    fetchPicture(type, id).success(function(html){\n        var imageSrc = $(html).find(linkTypes[type].posterSelector).attr('src') || linkTypes[type].anon;\n\n        pictresCache[type+'-'+id] = imageSrc;\n        setPictureSRC($img, imageSrc);\n\n    }).complete(function(xhr, status){\n        if(status == 'canceled'){\n            setPictureSRC($img, pictresCache[type+'-'+id]);\n        }\n    });\n};\n\nvar fetchPicture = function(type, id){\n    ajaxRequest = $.ajax({\n        url: \"/\"+ type +\"/\" + id,\n        dataType: \"html\",\n        beforeSend: function(xhr){\n            if(pictresCache[type+'-'+id]){\n                return false;\n            }\n        }\n    });\n\n    return ajaxRequest;\n};\n\nvar setPictureSRC = function($img, url){\n    $img.css({\"padding\":\"0\"});\n    $img.attr('src', url).load(function() {\n        calculatePreviewPosition();\n    });\n};\n\nfor (var type in linkTypes) {\n    anchorSelector = \"a[href^='/\"+ type +\"/']\";\n    $(document.body).on('hover mousemove', anchorSelector, setCoordinates);\n\n    $(document.body).on('mouseenter', anchorSelector, createPreview);\n    $(document.body).on('mousemove', anchorSelector, calculatePreviewPosition);\n    $(document.body).on('mouseleave', anchorSelector, removePreview);\n}\n\n"],"sourceRoot":"/source/"}